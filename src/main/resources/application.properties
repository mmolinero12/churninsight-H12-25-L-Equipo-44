spring.application.name=churninsight

# ================================================================
# HACKATON CHURNINSIGHT - CONFIGURACION POSTGRESQL
# ================================================================
# 1. CONFIGURACION DE CONEXION A BASES DE DATOS
# ================================================================
# ====================
# DATASOURCE PRIMARIO (db_security)
# ====================
spring.security-datasource.jdbc-url=jdbc:postgresql://${SECURITY_DB_HOST}:5432/db_security
spring.security-datasource.username=${SECURITY_DB_USER}
spring.security-datasource.password=${SECURITY_DB_PASSWORD}
spring.security-datasource.driver-class-name=org.postgresql.Driver

# ====================
# DATASOURCE SECUNDARIO (db_usuarios)
# ====================
spring.usuarios-datasource.jdbc-url=jdbc:postgresql://${USUARIOS_DB_HOST}:5432/db_usuarios
spring.usuarios-datasource.username=${USUARIOS_DB_USER}
spring.usuarios-datasource.password=${USUARIOS_DB_PASSWORD}
spring.usuarios-datasource.driver-class-name=org.postgresql.Driver


# ====================
# DATASOURCE TERCIARIO (db_ml_operations)
# ====================
spring.mloperations-datasource.jdbc-url=jdbc:postgresql://${MLOPERATIONS_DB_HOST}:5432/db_ml_operations
spring.mloperations-datasource.username=${MLOPERATIONS_DB_USER}
spring.mloperations-datasource.password=${MLOPERATIONS_DB_PASSWORD}
spring.mloperations-datasource.driver-class-name=org.postgresql.Driver


# ===========================================
# 2. CONFIGURACION FLYWAY (MIGRACIONES)
# ===========================================
# Deshabilita la autoconfiguracion global de Flyway (manejamos manualmente)
spring.flyway.enabled=false

# Configuracion especifica para db_security
flyway.security.enabled=true
flyway.security.locations=classpath:db/migration/security
flyway.security.table-name=security_flyway_history

# Configuracion especifica para db_usuarios
flyway.usuarios.enabled=true
flyway.usuarios.locations=classpath:db/migration/usuarios
flyway.usuarios.table-name=usuarios_flyway_history

# Configuracion especifica para db_mloperations
flyway.mloperations.enabled=true
flyway.mloperations.locations=classpath:db/migration/ml_operations
flyway.mloperations.table-name=mloperations_flyway_history

# ===========================================
# 2A. flyway.mloperations.baseline-on-migrate=true
# * Crea la tabla mloperations_flyway_history
# * Inserta una fila base (baseline)
# * NO borra nada
# * NO vuelve a ejecutar migraciones antiguas
# * A partir de ahi, Flyway controla todo
# ===========================================
flyway.mloperations.baseline-on-migrate=true

# ===========================================
# 3. CONFIGURACION JPA/HIBERNATE
# ===========================================
# NO permite que Hibernate modifique el esquema (Flyway lo hace)
spring.jpa.hibernate.ddl-auto=none

# Muestra las sentencias SQL generadas (util para desarrollo)
spring.jpa.show-sql=true

# Formatea las sentencias SQL para mejor legibilidad
spring.jpa.properties.hibernate.format_sql=true

# Dialecto especifico de PostgreSQL
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect

# ===========================================
# 5. CONFIGURACION DEL SERVIDOR
# ===========================================
# Establece el idioma de los mensajes de validacion a espanol
spring.web.locale=es

# Codificacion UTF-8 para mensajes
spring.messages.encoding=UTF-8

# No incluir trazas de stack en respuestas de error (produccion) - Descomentar cuando esté en produccion
# server.error.include-stacktrace=never

# ===========================================
# 6. CONFIGURACION DE LOGGING
# ===========================================
# Nivel de logging para ver detalles de Flyway
logging.level.org.flywaydb=DEBUG

# Nivel de logging para Spring (ajustar segun necesidad)
logging.level.org.springframework=INFO
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE


# ===========================================
# 7. CONFIGURACION DE SEGURIDAD (JWT)
# ===========================================
# Clave secreta para JWT (usar variable de entorno en produccion)
# Spring placeholders  $$ = $
api.security.token.secret=${JWT_SECRET:Ard1ll1t4$$}

# Tiempo de expiracion de tokens JWT (en horas)
api.security.jwt.expiration-hours=2



frontend.url=${URL_FRONTEND}
